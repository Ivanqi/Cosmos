# 中断描述符表概述
中断描述符表(Interrupt Descriptor Table, IDT)是保护模式下用于存储中断处理程序入口的表

当CPU接收一个中断时，需要用中断向量在此表中检索对应的描述符，在该描述符中找到中断处理程序的起始地址，然后执行中断处理程序

由于表中所有描述符都是记录一段程序的起始地址，相当于通向某段程序的"大门"，所以，中断描述符表中的描述符有自己名称-`门`


# 门
## 概述
门，顾名思义，是通往某处的入口。在计算机中，用门来表示一段程序入口。段描述符中描述的是一片内存区域，而门描述符中描述的是一段代码

## 任务门
![148c4d2679b208f7b7c8bda12ac3c194.png](evernotecid://95103871-7E20-47B6-A8DD-62C60FAB24B1/appyinxiangcom/15513169/ENResource/p14376)@w=600
任务门和任务状态段(Task Status Segment, TSS)是Intel处理器在硬件一级提供的任务切换机制，所以任务门需要和TSS配合在一起使用，在任务门中记录的是TSS选择子，偏移量未使用

任务门可以存在于全局描述符表GDT、局部描述符LDT、中断描述符IDT中。

描述符中任务门的type值为二进制0101

## 中断门
![47c62c582cbe3402fd78fe60a49140a2.png](evernotecid://95103871-7E20-47B6-A8DD-62C60FAB24B1/appyinxiangcom/15513169/ENResource/p14377)@w=600
中断门包含了中断处理程序所在段的段选择子和段内偏移地址

当通过此方式进入中断后，标志寄存器eflags中的IF位自动置0，也就是在进入中断后，自动把中断关闭，避免中断嵌套

Linux就是利用中断门实现的系统调用，就是那个著名的int 0x80。中断门只允许存在于IDT中，描述符中中断门的type值为二进制1110


## 陷阱门
![80e7c8bde00bffde5954b277a9db105e.png](evernotecid://95103871-7E20-47B6-A8DD-62C60FAB24B1/appyinxiangcom/15513169/ENResource/p14378)@w=600
陷阱门和中断门非常相似，区别是由陷阱门进入中断后，标志寄存器eflags中的IF位不会自动置0

陷阱门只允许存在于IDT中。描述符中陷阱门的type值为二进制1111

## 调用门
![42a24ff1ddb875e7d1a434999f369d55.png](evernotecid://95103871-7E20-47B6-A8DD-62C60FAB24B1/appyinxiangcom/15513169/ENResource/p14379)@w=600
调用门是提供给用户进程进入特权0级的方式，其DPL为3

调用门中记录例程的地址，它不能用int指令调用，只能用call和jmp指令

调用门可以安装在GDT和LDT中。描述符中调用门的type值为二进制1100

# 中断描述符寄存器IDTR
![7e8dd5a811b845b50724274baaeedd15.png](evernotecid://95103871-7E20-47B6-A8DD-62C60FAB24B1/appyinxiangcom/15513169/ENResource/p14380)@w=300

在CPU内部有个中断描述符表寄存器(Interrupt Descriptor Table Register, IDTR)，该寄存器

